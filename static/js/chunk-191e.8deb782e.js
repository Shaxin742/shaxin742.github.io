(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-191e"],{"0/u+":function(t,e,a){},"3s8Z":function(t,e,a){"use strict";var r=a("14Xm"),i=a.n(r),n=a("D3Ub"),o=a.n(n),s=a("kbZS"),l={directives:{elDragDialog:a("XINx").a},props:{fileList:{type:Array,default:function(){return[]}},uploadType:{type:String,default:function(){return"images"}}},data:function(){return{uploadTypeTrans:{photo:{urlPath:s.b,accept:"image/jpeg,image/png,image/bmp"},music:{urlPath:s.c,accept:"audio/mp3,video/mp4"},doc:{urlPath:s.a,accept:"application/pdf,text/plain,application/msword,application/excel,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.wordprocessingml.document"}},accept:"",dialogVisible:!1,seeTrans:{music:"歌曲",photo:"图片"},onClosed:function(){}}},mounted:function(){this.uploadType&&this.uploadTypeTrans[this.uploadType].accept&&(this.accept=this.uploadTypeTrans[this.uploadType].accept)},methods:{beforeAvatarUpload:function(t){var e=t.size/1024/1024<16;return e||this.$message.error("上传文件大小不能超过 16MB！"),e},handleRemove:function(t,e){var a=this;console.log(t,e),this.fileList.map(function(e,r){e.name===t.name&&(a.fileList.splice(r,1),a.$emit("getFileList",a.fileList))})},beforeRemove:function(t,e){return this.$confirm("确定移除 "+t.name+"？",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"})},uploadFile:function(t){var e=this;return o()(i.a.mark(function a(){var r,n;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,console.log(t),(r=new FormData).append(e.uploadType,t.file),a.next=6,e.uploadTypeTrans[e.uploadType].urlPath(r);case 6:0===(n=a.sent).error_code&&(n.data.map(function(a){e.fileList.push({name:t.file.name,url:a.file_url})}),e.$emit("getFileList",e.fileList),e.$emit("fileSize",t.file.size),e.$message.success("上传成功")),console.log(e.fileList),a.next=15;break;case 11:a.prev=11,a.t0=a.catch(0),e.fileList.pop(),e.$message.error("上传文件错误: "+a.t0.message);case 15:return a.prev=15,e.$store.commit("CLOSE_WAITING"),a.finish(15);case 18:case"end":return a.stop()}},a,e,[[0,11,15,18]])}))()},handlePreview:function(t){var e={file:t,type:this.uploadType};this.$emit("showFile",e)},handleExceed:function(t,e){this.$message.warning("当前限制选择 1 个文件，本次选择了 "+t.length+" 个文件，共选择了 "+(t.length+e.length)+" 个文件")}}},c=a("KHd+"),u=Object(c.a)(l,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-upload",{staticClass:"upload-demo",attrs:{"on-preview":t.handlePreview,"on-remove":t.handleRemove,"before-remove":t.beforeRemove,"before-upload":t.beforeAvatarUpload,limit:1,"on-exceed":t.handleExceed,"file-list":t.fileList,"http-request":t.uploadFile,accept:t.accept,action:""}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传"+t._s(t.seeTrans[t.uploadType])+"文件，且不超过16Mb")])],1)],1)},[],!1,null,null,null);u.options.__file="index.vue";e.a=u.exports},"9av9":function(t,e,a){},A0pR:function(t,e,a){"use strict";var r=a("VOyg");a.n(r).a},Bc3G:function(t,e,a){},CM5h:function(t,e,a){"use strict";a.r(e);var r=a("EQU6"),i=a("XINx"),n=a("3s8Z"),o=a("Mz3J"),s=a("oY74"),l=a("zEiY"),c={name:"DoDialog",directives:{elDragDialog:i.a},components:{pagination:o.a},data:function(){return{dialogVisible:!1,currentTotal:7,currentPage:1,searchVal:"",lasrSearchVal:"",flag:!1,tableData:[],currentRow:null,addedSongData:[]}},computed:{hasSelect:function(){return null!==this.currentRow},hasSearch:function(){return""!==this.searchVal.trim()}},methods:{open:function(t){var e=Object(s.a)(t);this.addedSongData=e,this.dialogVisible=!0,this.tableData=[],this.searchVal="",this.$refs.pageN.init()},init:function(){this.addedSongData=[]},CurrentPage:function(t){this.currentPage=t,this.search()},search:function(){var t=this;this.loading=!0,this.flag?this.lasrSearchVal!==this.searchVal&&(this.currentPage=1,this.$refs.pageN.init(),this.flag=!1):(this.lasrSearchVal=this.searchVal,this.flag=!0),this.isSearch||(this.currentPage=1,this.$refs.pageN.init()),this.isSearch=!0;var e="/Musics/"+this.searchVal+"/"+this.currentPage+"/7";Object(l.t)(e).then(function(e){0===e.error_code?(t.loading=!1,t.currentTotal=e.data[0].total,0===e.data[0].music_list.length&&t.$message.error("暂无该歌曲，请添加"),t.tableData=e.data[0].music_list):t.loading=!1})},addtableChange:function(t){this.currentRow=t},addNew:function(){console.log(this.addedSongData),this.addedSongData.push(this.currentRow);var t;t=Object(s.b)(this.addedSongData),console.log(t),this.addedSongData=t},handleClose:function(t){this.addedSongData.splice(this.addedSongData.indexOf(t),1)},confirm:function(){this.$emit("addSongData",this.addedSongData),this.dialogVisible=!1}}},u=(a("qHue"),a("KHd+")),d=Object(u.a)(c,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],staticClass:"content",attrs:{visible:t.dialogVisible,title:"选择歌曲",width:"65%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",[a("el-card",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:9}},[a("div",{staticStyle:{"font-size":"18px","line-height":"40px"}},[t._v("搜索歌曲")])]),t._v(" "),a("el-col",{attrs:{span:7}},[a("div",{staticStyle:{"text-align":"right"}},[a("el-input",{attrs:{placeholder:"请输入内容",clearable:""},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.search(e):null}},model:{value:t.searchVal,callback:function(e){t.searchVal=e},expression:"searchVal"}})],1)]),t._v(" "),a("el-col",{attrs:{span:5}},[a("el-button",{attrs:{disabled:!t.hasSearch,type:"primary",icon:"el-icon-search",circle:""},on:{click:function(e){t.search()}}}),t._v(" "),a("el-button",{attrs:{disabled:!t.hasSelect,type:"primary",icon:"el-icon-circle-plus-outline",circle:""},on:{click:function(e){t.addNew()}}})],1),t._v(" "),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.confirm()}}},[t._v("提交")])],1)],1)],1),t._v(" "),t.addedSongData.length>0?a("el-card",t._l(t.addedSongData,function(e,r){return a("el-tag",{key:r,attrs:{"disable-transitions":!1,closable:""},on:{close:function(a){t.handleClose(e)}}},[t._v("\n          "+t._s(e.name)+"\n        ")])})):t._e(),t._v(" "),a("el-card",{directives:[{name:"show",rawName:"v-show",value:t.tableData.length>0,expression:"tableData.length>0"}]},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"","highlight-current-row":"",stripe:""},on:{"current-change":t.addtableChange}},[a("el-table-column",{attrs:{prop:"name",label:"歌曲名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"artist_name",label:"歌手"}}),t._v(" "),a("el-table-column",{attrs:{prop:"album_name",label:"专辑名"}})],1)],1),t._v(" "),a("el-card",{directives:[{name:"show",rawName:"v-show",value:t.tableData.length>0,expression:"tableData.length>0"}]},[a("div",{staticClass:"block",staticStyle:{"text-align":"right"}},[a("pagination",{ref:"pageN",attrs:{"current-total":t.currentTotal,"current-page":t.currentPage},on:{CurrentPage:t.CurrentPage}})],1)])],1)])],1)},[],!1,null,"95d91e3c",null);d.options.__file="chooseSong.vue";var h=d.exports,f=a("bfoT"),p={name:"UserManage",directives:{elDragDialog:i.a},components:{pagination:o.a},data:function(){return{dialogVisible:!1,currentTotal:7,currentPage:1,searchVal:"",lasrSearchVal:"",flag:!1,loading:!1,tableData:[],multipleSelection:[],currentRow:null,isSearch:!1,stateTrans:{1:"有",0:"没有"},statusTypeTrans:{1:"已激活",0:"未激活"},albumType:[]}},computed:{hasSelect:function(){return null!==this.currentRow},hasSearch:function(){return""!==this.searchVal.trim()}},watch:{searchVal:function(t,e){""===t&&this.loadData()}},methods:{fetchData:function(){this.isSearch?this.search():this.loadData()},loadData:function(){var t=this;try{this.loading=!0,this.isSearch&&(this.currentPage=1,this.$refs.pageN.init()),this.isSearch=!1;var e={page_index:this.currentPage,page_size:7,is_chl:0};Object(f.f)(e).then(function(e){t.loading=!1,t.currentTotal=e.data[0].total;var a=t.stateTrans;e.data[0].data.map(function(e,r){e.status_type=t.statusTypeTrans[e.status_type],e.have_contact=a[e.have_contact],e.have_contract=a[e.have_contract],e.have_musics=a[e.have_musics],e.have_lrc=a[e.have_lrc],e.have_mv=a[e.have_mv],e.have_total_music=a[e.have_total_music],e.have_ring=a[e.have_ring],e.is_channel=a[e.is_channel]}),t.tableData=e.data[0].data})}catch(t){this.$message.error("获取数据失败")}},CurrentPage:function(t){this.currentPage=t,this.fetchData()},search:function(){var t=this;if(""!==this.searchVal.trim()){this.loading=!0,this.flag?this.lasrSearchVal!==this.searchVal&&(this.currentPage=1,this.$refs.pageN.init(),this.flag=!1):(this.lasrSearchVal=this.searchVal,this.flag=!0),this.isSearch||(this.currentPage=1,this.$refs.pageN.init()),this.isSearch=!0;var e="/Companys/"+this.searchVal+"/"+this.currentPage+"/7/0/";Object(f.j)(e).then(function(e){t.loading=!1,t.currentTotal=e.data[0].total;var a=t.stateTrans;e.data[0].data.map(function(e,r){e.status_type=t.statusTypeTrans[e.status_type],e.have_contact=a[e.have_contact],e.have_contract=a[e.have_contract],e.have_musics=a[e.have_musics],e.have_lrc=a[e.have_lrc],e.have_mv=a[e.have_mv],e.have_total_music=a[e.have_total_music],e.have_ring=a[e.have_ring],e.is_channel=a[e.is_channel]}),t.tableData=e.data[0].data})}},handleCurrenttableChange:function(t){this.currentRow=t},open:function(t){this.currentRow=null,this.dialogVisible=!0,this.fetchData()},confirm:function(){console.log(this.currentRow),this.$emit("addParty",this.currentRow),this.dialogVisible=!1}}},m=(a("UuNu"),Object(u.a)(p,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],staticClass:"content",attrs:{visible:t.dialogVisible,title:"选择公司",width:"40%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",[a("el-card",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",{staticStyle:{"font-size":"18px","line-height":"40px"}},[t._v("搜索歌曲")])]),t._v(" "),a("el-col",{attrs:{span:7}},[a("div",{staticStyle:{"text-align":"right"}},[a("el-input",{attrs:{placeholder:"请输入内容",clearable:""},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.search(e):null}},model:{value:t.searchVal,callback:function(e){t.searchVal=e},expression:"searchVal"}})],1)]),t._v(" "),a("el-col",{attrs:{span:5}},[a("el-button",{attrs:{disabled:!t.hasSearch,type:"primary",icon:"el-icon-search",circle:""},on:{click:function(e){t.search()}}})],1),t._v(" "),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{disabled:!t.hasSelect,type:"primary"},on:{click:function(e){t.confirm()}}},[t._v("提交")])],1)],1)],1),t._v(" "),a("el-card",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",stripe:"","highlight-current-row":""},on:{"current-change":t.handleCurrenttableChange}},[a("el-table-column",{attrs:{prop:"name",label:"公司名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"org_type",label:"公司类型"}}),t._v(" "),a("el-table-column",{attrs:{prop:"description",label:"公司描述"}})],1)],1),t._v(" "),a("el-card",[a("div",{staticClass:"block",staticStyle:{"text-align":"right"}},[a("pagination",{ref:"pageN",attrs:{"current-total":t.currentTotal,"current-page":t.currentPage},on:{CurrentPage:t.CurrentPage}})],1)])],1)])],1)},[],!1,null,"7f7efc50",null));m.options.__file="chooseParty.vue";var g=m.exports,_=a("mt6u"),v={name:"DoDialog",directives:{elDragDialog:i.a},components:{upload:n.a,pdfViewer:r.a,chooseSong:h,chooseParty:g},data:function(){return{dialogVisible:!1,fileList:[],addSongDataList:[],title:"",form:{title:"",party_a_org_id:"",party_a_org_name:"",party_a_assoc:"",party_a_tel:"",party_b_org_id:"",party_b_assoc:"",party_b_tel:"",start_time:"",end_time:"",description:"",file_path:"",proportion:"",musics_id:[],is_channel:0,price:3},formRules:{title:[{required:!0,trigger:"blur",message:"请输入标题"}],party_a_assoc:[{required:!0,trigger:"blur",message:"请输入甲方联系人"}],party_a_tel:[{required:!0,trigger:"blur",message:"请输入甲方电话"},{pattern:/^1[34578]\d{9}$/,message:"请输入正确的电话."}],party_b_assoc:[{required:!0,trigger:"blur",message:"请输入乙方联系人"}],party_b_tel:[{required:!0,trigger:"blur",message:"请输入乙方电话"},{pattern:/^1[34578]\d{9}$/,message:"请输入正确的电话."}],start_time:[{required:!0,trigger:"blur",message:"请输入开始时间"}],end_time:[{required:!0,trigger:"blur",message:"请输入结束时间"}],description:[{required:!0,trigger:"blur",message:"请输入描述"}],proportion:[{required:!0,trigger:"blur",message:"请输入分成比"}]},onClosed:function(){}}},watch:{addSongDataList:function(t){console.log(this.addSongDataList)}},methods:{init:function(){this.$store.commit("CLOSE_WAITING"),this.title="新增合同信息",this.form.title="",this.form.party_a_org_id="",this.form.party_a_org_name="",this.form.party_a_assoc="",this.form.party_a_tel="",this.form.party_b_org_id="",this.form.party_b_assoc="",this.form.party_b_tel="",this.form.start_time="",this.form.end_time="",this.form.price=3,this.form.description="",this.form.proportion="",this.file_path="",this.fileList=[],this.form.musics_id=[],this.addSongDataList=[]},handleClose:function(t){this.$confirm("确认关闭？","确认信息",{confirmButtonText:"确认",cancelButtonText:"取消"}).then(function(e){t()}).catch(function(t){})},open:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log(e),this.dialogVisible=!0,this.$nextTick(function(){t.$refs.form.clearValidate()}),this.init(e)},close:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_.a.CLOSE;if(this.dialogVisible&&(this.dialogVisible=!1,"function"==typeof this.onClosed)){var e={option:t,sender:this};this.onClosed(e)}},confirm:function(){var t=this;console.log(this.form),console.log(this.form.musics_id);try{this.$refs.form.validate(function(e){if(e){if(""===t.form.party_a_org_name)return void t.$message.error("请选择甲方公司");if(0===t.form.musics_id.length)return void t.$message.error("请选择歌曲");if(t.form.start_time>=t.form.end_time)return void t.$message.error("请正确选择时间");if(!t.form.file_path)return void t.$message.error("请选择图片");t.$store.commit("SHOW_WAITING"),Object(f.b)(t.form).then(function(e){console.log(e),t.$store.commit("CLOSE_WAITING"),0===e.error_code&&(t.$message({message:"提交成功",type:"success"}),t.close(_.a.CONFIRM))})}})}catch(t){this.$message.error("获取数据失败"),this.$store.commit("CLOSE_WAITING")}},getFileList:function(t){this.form.file_path=this.$urlTrans(t),console.log(this.form.file_path)},showFile:function(t){"PDF"===t.file.url.substr(t.file.url.lastIndexOf(".")).toLowerCase()?this.$refs.pdfViewer.open(t.file.url):this.$message.error("暂不支持该类型文件查看")},chooseSong:function(){this.$refs.chooseSong.open(this.addSongDataList)},addSongData:function(t){var e=this;this.addSongDataList=t,this.addSongDataList.map(function(t){e.form.musics_id.push(t.id)});var a;a=Object(s.e)(this.form.musics_id),this.form.musics_id=a},chooseParty:function(){this.$refs.chooseParty.open()},addParty:function(t){this.form.party_a_org_name=t.name,this.form.party_a_org_id=t.id}}},b=(a("A0pR"),Object(u.a)(v,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],staticClass:"content",attrs:{visible:t.dialogVisible,"before-close":t.handleClose,title:t.title,width:"65%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.formRules,"label-width":"80px"}},[a("el-form-item",{staticClass:"wid50 fll",attrs:{label:"标题",prop:"title"}},[a("el-input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),a("el-form-item",{staticClass:"wid50 fll",attrs:{label:"描述",prop:"description"}},[a("el-input",{model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),t._v(" "),a("el-form-item",{staticClass:"wid50 fll omit",attrs:{label:"甲方公司",prop:"party_a_org_id"}},[a("el-button",{on:{click:t.chooseParty}},[t._v("选择甲方")]),t._v(" "),t.form.party_a_org_name?a("span",[t._v(" 已选择甲方为："),a("i",{staticStyle:{color:"#409eff","font-style":"normal"}},[t._v(t._s(t.form.party_a_org_name))])]):t._e()],1),t._v(" "),a("el-form-item",{staticClass:"wid50 fll",attrs:{label:"甲方联系人",prop:"party_a_assoc"}},[a("el-input",{model:{value:t.form.party_a_assoc,callback:function(e){t.$set(t.form,"party_a_assoc",e)},expression:"form.party_a_assoc"}})],1),t._v(" "),a("el-form-item",{staticClass:"wid50 fll",attrs:{label:"联系人电话",prop:"party_a_tel"}},[a("el-input",{model:{value:t.form.party_a_tel,callback:function(e){t.$set(t.form,"party_a_tel",e)},expression:"form.party_a_tel"}})],1),t._v(" "),a("el-form-item",{staticClass:"wid50 fll",attrs:{label:"乙方公司",prop:"party_b_org_id"}},[a("el-input",{attrs:{value:"广州滚石移动网络有限公司",disabled:""}})],1),t._v(" "),a("el-form-item",{staticClass:"wid50 fll",attrs:{label:"乙方联系人",prop:"party_b_assoc"}},[a("el-input",{model:{value:t.form.party_b_assoc,callback:function(e){t.$set(t.form,"party_b_assoc",e)},expression:"form.party_b_assoc"}})],1),t._v(" "),a("el-form-item",{staticClass:"wid50 fll",attrs:{label:"联系人电话",prop:"party_b_tel"}},[a("el-input",{model:{value:t.form.party_b_tel,callback:function(e){t.$set(t.form,"party_b_tel",e)},expression:"form.party_b_tel"}})],1),t._v(" "),a("el-form-item",{staticClass:"wid50 fll",attrs:{label:"开始时间",prop:"start_time"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.form.start_time,callback:function(e){t.$set(t.form,"start_time",e)},expression:"form.start_time"}})],1),t._v(" "),a("el-form-item",{staticClass:"wid50 fll",attrs:{label:"结束时间",prop:"end_time"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.form.end_time,callback:function(e){t.$set(t.form,"end_time",e)},expression:"form.end_time"}})],1),t._v(" "),a("el-form-item",{staticClass:"wid50 fll",attrs:{label:"分成比例",prop:"proportion"}},[a("el-input-number",{attrs:{precision:0,step:1,min:0,max:100},model:{value:t.form.proportion,callback:function(e){t.$set(t.form,"proportion",e)},expression:"form.proportion"}}),t._v(" "),a("span",{staticStyle:{"font-size":"16px","margin-left":"8px"}},[t._v("%")])],1),t._v(" "),a("el-form-item",{staticClass:"wid50 fll",attrs:{label:"价格",prop:"price"}},[a("el-input-number",{attrs:{precision:0,step:1,min:0,max:100},model:{value:t.form.price,callback:function(e){t.$set(t.form,"price",e)},expression:"form.price"}}),a("span",{staticStyle:{"margin-left":"8px"}},[t._v("元/月")])],1),t._v(" "),a("el-form-item",{staticClass:"wid50 fll",attrs:{label:"选择歌曲",prop:"proportion"}},[a("el-button",{on:{click:t.chooseSong}},[t._v("选择歌曲")]),t._v(" "),a("span",[t._v(" 已选择"),a("i",{staticStyle:{color:"#409eff","font-style":"normal"}},[t._v(t._s(t.addSongDataList.length))]),t._v("首歌曲")])],1),t._v(" "),a("el-form-item",{staticStyle:{clear:"both"}},[a("upload",{attrs:{"file-list":t.fileList,"upload-type":"doc"},on:{getFileList:t.getFileList,showFile:t.showFile}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.confirm()}}},[t._v("确定")])],1)],1)],1)]),t._v(" "),a("pdfViewer",{ref:"pdfViewer"}),t._v(" "),a("choose-song",{ref:"chooseSong",on:{addSongData:t.addSongData}}),t._v(" "),a("choose-party",{ref:"chooseParty",on:{addParty:t.addParty}})],1)},[],!1,null,"c15f282a",null));b.options.__file="doDialog.vue";var y=b.exports,S={name:"DoDialog",directives:{elDragDialog:i.a},components:{pagination:o.a},data:function(){return{dialogVisible:!1,currentTotal:7,currentPage:1,searchVal:"",lasrSearchVal:"",flag:!1,tableData:[],currentId:""}},computed:{hasSearch:function(){return""!==this.searchVal.trim()}},watch:{searchVal:function(t,e){""===t&&this.loadData()}},methods:{open:function(t){this.dialogVisible=!0,this.loadData(t.id)},fetchData:function(){this.isSearch?this.search():this.loadData()},loadData:function(t){var e=this;try{this.loading=!0,t&&(this.currentId=t),this.isSearch&&(this.currentPage=1,this.$refs.pageN.init()),this.isSearch=!1;var a="/Contracts/"+this.currentId+"/"+this.currentPage+"/7/0/";Object(f.l)(a).then(function(t){0===t.error_code&&(e.loading=!1,e.currentTotal=t.data[0].total,t.data[0].data.map(function(t){t.price_t=t.price+"元/月"}),e.tableData=t.data[0].data)})}catch(t){this.$message.error("获取数据失败")}},CurrentPage:function(t){this.currentPage=t,this.fetchData()}}},w=(a("w23K"),Object(u.a)(S,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],staticClass:"content",attrs:{visible:t.dialogVisible,title:"歌单信息",width:"60%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",[a("el-card",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{prop:"name",label:"歌曲名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"album_name",label:"专辑名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"artist_name",label:"歌手"}}),t._v(" "),a("el-table-column",{attrs:{prop:"price_t",label:"价格"}})],1)],1),t._v(" "),a("el-card",[a("div",{staticClass:"block",staticStyle:{"text-align":"right"}},[a("pagination",{ref:"pageN",attrs:{"current-total":t.currentTotal,"current-page":t.currentPage},on:{CurrentPage:t.CurrentPage}})],1)])],1)])],1)},[],!1,null,"380b3d50",null));w.options.__file="playlist.vue";var D=w.exports,C=a("23rR"),$=(a("dunZ"),a("dunZ")),x={name:"UserManage",components:{doDialog:y,playList:D,titleLeft:C.a,pdfViewer:r.a,pagination:o.a},data:function(){return{currentTotal:7,currentPage:1,searchVal:"",lasrSearchVal:"",flag:!1,areaTrans:{1:"大陆",2:"港台",3:"欧美",4:"日韩",5:"其他"},genderTrans:{1:"男歌手",2:"女歌手",3:"组合乐队",4:"其他"},hotTrans:{1:"热门",0:"不热门"},loading:!1,tableData:[],multipleSelection:[],currentRow:null,isSearch:!1,canBoTest:!0}},computed:{hasSelect:function(){return null!==this.currentRow},hasChecked:function(){return 0!==this.multipleSelection.length||null!==this.currentRow},hasSearch:function(){return""!==this.searchVal.trim()}},watch:{searchVal:function(t,e){""===t&&this.loadData()}},mounted:function(){this.canBoTest="admin"===s.g[sessionStorage.getItem("userType")],this.loadData()},methods:{fetchData:function(){this.isSearch?this.search():this.loadData()},loadData:function(){var t=this;try{this.loading=!0,this.isSearch&&(this.currentPage=1,this.$refs.pageN.init()),this.isSearch=!1;var e={page_index:this.currentPage,page_size:7,is_chl:0};Object(f.g)(e).then(function(e){0===e.error_code&&(t.loading=!1,t.currentTotal=e.data[0].total,t.tableData=e.data[0].data)})}catch(t){this.$message.error("获取数据失败")}},CurrentPage:function(t){this.currentPage=t,this.fetchData()},search:function(){var t=this;if(""!==this.searchVal.trim()){this.loading=!0,this.flag?this.lasrSearchVal!==this.searchVal&&(this.currentPage=1,this.$refs.pageN.init(),this.flag=!1):(this.lasrSearchVal=this.searchVal,this.flag=!0),this.isSearch||(this.currentPage=1,this.$refs.pageN.init()),this.isSearch=!0;var e="/Contracts/"+this.searchVal+"/"+this.currentPage+"/7/0/";Object(f.k)(e).then(function(e){0===e.error_code?(t.loading=!1,t.currentTotal=e.data[0].total,t.tableData=e.data[0].data):t.loading=!1})}},handleSelectionChange:function(t){this.multipleSelection=t},handleCurrenttableChange:function(t){this.currentRow=t},tableRowClassName:function(t){var e=t.row;t.rowIndex;return 0===e.status?"warning-row":""},edit:function(){var t=this;t.$refs.doDialog.open(this.currentRow),t.$refs.doDialog.onClosed=function(e){e.option===_.a.CONFIRM&&t.fetchData()}},addNew:function(){var t=this;t.$refs.doDialog.open(),t.$refs.doDialog.onClosed=function(e){e.option===_.a.CONFIRM&&t.fetchData()}},remove:function(){var t=this;this.$confirm("此操作将永久修改该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e=[];t.multipleSelection.length>0?e=t.multipleSelection:e.push(t.currentRow);var a=[],r=!0;if(e.map(function(t){0!==t.status?a.push(t.id):r=!1}),r){var i={deleted_id:a};Object(f.c)(i).then(function(e){1===e.error_code&&(t.fetchData(),t.$message({type:"success",message:"修改成功!"}))})}else t.$message.error("不可删除已失效合同"),a=[]}).catch(function(){t.$message({type:"info",message:"已取消修改"})})},downPdf:function(t){console.log(t),$.saveAs(t.file_path,"合同")},openPdf:function(t){console.log(t),"PDF"===t.file_path.substr(t.file_path.lastIndexOf(".")).toLowerCase()?this.$refs.pdfViewer.open():$.saveAs(t.file_path,"合同")},openSongList:function(t){this.$refs.playList.open(t)}}},V=(a("m3hI"),Object(u.a)(x,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-card",{attrs:{shadow:"hover"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:9}},[a("titleLeft")],1),t._v(" "),a("el-col",{attrs:{span:t.canBoTest?6:10}},[a("div",{staticStyle:{"line-height":"40px",height:"40px",color:"#f14141","font-size":"18px"}},[t._v("\n          红色行表示该合同已失效\n        ")])]),t._v(" "),a("el-col",{attrs:{span:4}},[a("div",{staticStyle:{"text-align":"right"}},[a("el-input",{attrs:{placeholder:"请输入内容",clearable:""},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.search(e):null}},model:{value:t.searchVal,callback:function(e){t.searchVal=e},expression:"searchVal"}})],1)]),t._v(" "),a("el-col",{attrs:{span:1}},[a("el-button",{attrs:{disabled:!t.hasSearch,type:"primary",icon:"el-icon-search",circle:""},on:{click:function(e){t.search()}}})],1),t._v(" "),t.canBoTest?a("el-col",{attrs:{span:4}},[a("div",{staticStyle:{"text-align":"right"}},[this.$operationTrans[this.$store.state.routerAuth.canAdd]?a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline",circle:""},on:{click:function(e){t.addNew()}}}):t._e(),t._v(" "),this.$operationTrans[this.$store.state.routerAuth.canDelete]?a("el-button",{attrs:{disabled:!t.hasChecked,type:"warning",icon:"el-icon-refresh",circle:""},on:{click:function(e){t.remove()}}}):t._e()],1)]):t._e()],1)],1),t._v(" "),a("el-card",{attrs:{shadow:"hover"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticClass:"floRight table",staticStyle:{width:"100%"},attrs:{data:t.tableData,"row-class-name":t.tableRowClassName,border:"","highlight-current-row":"","tooltip-effect":"dark"},on:{"current-change":t.handleCurrenttableChange,"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"35"}}),t._v(" "),a("el-table-column",{attrs:{prop:"title",label:"标题"}}),t._v(" "),a("el-table-column",{attrs:{prop:"party_a_org_name",label:"合作方公司"}}),t._v(" "),a("el-table-column",{attrs:{prop:"party_a_assoc",label:"合作方联系人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"party_a_tel",label:"合作方电话"}}),t._v(" "),a("el-table-column",{attrs:{prop:"start_time",label:"授权开始日期"}}),t._v(" "),a("el-table-column",{attrs:{prop:"end_time",label:"授权结束日期"}}),t._v(" "),a("el-table-column",{attrs:{prop:"create_time",label:"签署日期"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"合同附件",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.openPdf(e.row)}}},[t._v("查看")])]}}])}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"歌单信息",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.openSongList(e.row)}}},[t._v("查看")])]}}])})],1)],1),t._v(" "),a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticClass:"block",staticStyle:{"text-align":"right"}},[a("pagination",{ref:"pageN",attrs:{"current-total":t.currentTotal,"current-page":t.currentPage},on:{CurrentPage:t.CurrentPage}})],1)]),t._v(" "),a("do-dialog",{ref:"doDialog"}),t._v(" "),a("play-list",{ref:"playList"}),t._v(" "),a("pdf-viewer",{ref:"pdfViewer"})],1)},[],!1,null,"6a7cbfc2",null));V.options.__file="index.vue";e.default=V.exports},UuNu:function(t,e,a){"use strict";var r=a("vz7Z");a.n(r).a},VOyg:function(t,e,a){},bfoT:function(t,e,a){"use strict";a.d(e,"f",function(){return i}),a.d(e,"j",function(){return n}),a.d(e,"d",function(){return o}),a.d(e,"a",function(){return s}),a.d(e,"b",function(){return l}),a.d(e,"g",function(){return c}),a.d(e,"k",function(){return u}),a.d(e,"l",function(){return d}),a.d(e,"c",function(){return h}),a.d(e,"i",function(){return f}),a.d(e,"h",function(){return p}),a.d(e,"e",function(){return m});var r=a("t3Un");function i(t){return Object(r.a)({url:"/Companys",method:"get",params:t})}function n(t){return Object(r.a)({url:t,method:"get"})}function o(t){return Object(r.a)({url:"/Companys",method:"put",data:t})}function s(t){return Object(r.a)({url:"/Companys",method:"post",data:t})}function l(t){return Object(r.a)({url:"/Contracts",method:"post",data:t})}function c(t){return Object(r.a)({url:"/Contracts",method:"get",params:t})}function u(t){return Object(r.a)({url:t,method:"get"})}function d(t){return Object(r.a)({url:t,method:"get"})}function h(t){return Object(r.a)({url:"/Contracts",method:"delete",data:t})}function f(t){return Object(r.a)({url:"/SongLists",method:"get",params:t})}function p(){return Object(r.a)({url:"/BoLogs",method:"get"})}function m(t){return Object(r.a)({url:t,method:"get"})}},kbZS:function(t,e,a){"use strict";a.d(e,"b",function(){return i}),a.d(e,"c",function(){return n}),a.d(e,"a",function(){return o});var r=a("t3Un");function i(t){return Object(r.a)({url:"/Uploads/image",method:"post",headers:{"Content-Type":"multipart/form-data"},data:t})}function n(t){return Object(r.a)({url:"/Uploads/music",method:"post",headers:{"Content-Type":"multipart/form-data"},data:t})}function o(t){return Object(r.a)({url:"/Uploads/doc",method:"post",headers:{"Content-Type":"multipart/form-data"},data:t})}},m3hI:function(t,e,a){"use strict";var r=a("0/u+");a.n(r).a},qHue:function(t,e,a){"use strict";var r=a("9av9");a.n(r).a},vz7Z:function(t,e,a){},w23K:function(t,e,a){"use strict";var r=a("Bc3G");a.n(r).a},zEiY:function(t,e,a){"use strict";a.d(e,"p",function(){return i}),a.d(e,"t",function(){return n}),a.d(e,"d",function(){return o}),a.d(e,"l",function(){return s}),a.d(e,"h",function(){return l}),a.d(e,"i",function(){return c}),a.d(e,"o",function(){return u}),a.d(e,"s",function(){return d}),a.d(e,"c",function(){return h}),a.d(e,"k",function(){return f}),a.d(e,"g",function(){return p}),a.d(e,"a",function(){return m}),a.d(e,"n",function(){return g}),a.d(e,"r",function(){return _}),a.d(e,"b",function(){return v}),a.d(e,"j",function(){return b}),a.d(e,"f",function(){return y}),a.d(e,"q",function(){return S}),a.d(e,"u",function(){return w}),a.d(e,"e",function(){return D}),a.d(e,"m",function(){return C});var r=a("t3Un");function i(t){return Object(r.a)({url:"/Musics",method:"get",params:t})}function n(t){return Object(r.a)({url:t,method:"get"})}function o(t){return Object(r.a)({url:"/Musics",method:"post",data:t})}function s(t){return Object(r.a)({url:"/Musics",method:"put",data:t})}function l(t){return Object(r.a)({url:"/Musics",method:"delete",data:t})}function c(t){return Object(r.a)({url:"/DownTimes",method:"get",params:t})}function u(t){return Object(r.a)({url:"/Artists",method:"get",params:t})}function d(t){return Object(r.a)({url:t,method:"get"})}function h(t){return Object(r.a)({url:"/Artists",method:"post",data:t})}function f(t){return Object(r.a)({url:"/Artists",method:"put",data:t})}function p(t){return Object(r.a)({url:"/Artists",method:"delete",data:t})}function m(t){return Object(r.a)({url:t,method:"get"})}function g(t){return Object(r.a)({url:"/Albums",method:"get",params:t})}function _(t){return Object(r.a)({url:t,method:"get"})}function v(t){return Object(r.a)({url:"/Albums",method:"post",data:t})}function b(t){return Object(r.a)({url:"/Albums",method:"put",data:t})}function y(t){return Object(r.a)({url:"/Albums",method:"delete",data:t})}function S(t){return Object(r.a)({url:"/Styles",method:"get",params:t})}function w(t){return Object(r.a)({url:t,method:"get"})}function D(t){return Object(r.a)({url:"/Styles",method:"post",data:t})}function C(t){return Object(r.a)({url:"/Styles",method:"put",data:t})}}}]);