(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3e4a"],{"3XZd":function(t,e,a){"use strict";var n=a("CT/w");a.n(n).a},"CT/w":function(t,e,a){},EF5k:function(t,e,a){"use strict";a.d(e,"c",function(){return i}),a.d(e,"d",function(){return r}),a.d(e,"b",function(){return o}),a.d(e,"a",function(){return l});var n=a("t3Un");function i(t){return Object(n.a)({url:"/Announcements",method:"get",params:t})}function r(t){return Object(n.a)({url:t,method:"get"})}function o(t){return Object(n.a)({url:"/Announcements",method:"delete",data:t})}function l(t){return Object(n.a)({url:"/Announcements",method:"post",data:t})}},IhUM:function(t,e,a){"use strict";a.r(e);var n=a("XINx"),i=a("EF5k"),r=a("mt6u"),o={name:"DoDialog",directives:{elDragDialog:n.a},data:function(){return{dialogVisible:!1,fileList:[],title:"",form:{title:"",content:"",is_channel:1},formRules:{title:[{required:!0,trigger:"blur",message:"请输入标题"}],content:[{required:!0,trigger:"blur",message:"请输入公告"}]},onClosed:function(){}}},methods:{init:function(){this.$store.commit("CLOSE_WAITING"),this.title="新增公告信息",this.form.title="",this.form.content=""},handleClose:function(t){this.$confirm("确认关闭？","确认信息",{confirmButtonText:"确认",cancelButtonText:"取消"}).then(function(e){t()}).catch(function(t){})},open:function(){var t=this;this.dialogVisible=!0,this.$nextTick(function(){t.$refs.form.clearValidate()}),this.init()},close:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.a.CLOSE;if(this.dialogVisible&&(this.dialogVisible=!1,"function"==typeof this.onClosed)){var e={option:t,sender:this};this.onClosed(e)}},confirm:function(){var t=this;console.log(this.form);try{this.$refs.form.validate(function(e){e&&Object(i.a)(t.form).then(function(e){console.log(e),0===e.error_code&&(t.$message({message:"提交成功",type:"success"}),t.close(r.a.CONFIRM))})})}catch(t){this.$message.error("获取数据失败")}}}},l=a("KHd+"),s=Object(l.a)(o,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],staticClass:"content",attrs:{visible:t.dialogVisible,"before-close":t.handleClose,title:t.title,width:"40%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.formRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"内容",prop:"content"}},[a("el-input",{attrs:{rows:2,type:"textarea"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.confirm()}}},[t._v("确定")])],1)],1)],1)])],1)},[],!1,null,null,null);s.options.__file="doDialog.vue";var c=s.exports,u=a("23rR"),h=a("Mz3J"),d=a("EQU6"),f={name:"UserManage",components:{doDialog:c,titleLeft:u.a,pdfViewer:d.a,pagination:h.a},data:function(){return{currentTotal:7,currentPage:1,searchVal:"",lasrSearchVal:"",flag:!1,areaTrans:{1:"大陆",2:"港台",3:"欧美",4:"日韩",5:"其他"},genderTrans:{1:"男歌手",2:"女歌手",3:"组合乐队",4:"其他"},hotTrans:{1:"热门",0:"不热门"},loading:!1,tableData:[],multipleSelection:[],currentRow:null,isSearch:!1}},computed:{hasSelect:function(){return null!==this.currentRow},hasChecked:function(){return 0!==this.multipleSelection.length||null!==this.currentRow},hasSearch:function(){return""!==this.searchVal.trim()}},watch:{searchVal:function(t,e){""===t&&this.loadData()}},mounted:function(){this.loadData()},methods:{fetchData:function(){this.isSearch?this.search():this.loadData()},loadData:function(){var t=this;try{this.loading=!0,this.isSearch&&(this.currentPage=1,this.$refs.pageN.init()),this.isSearch=!1;var e={page_index:this.currentPage,page_size:7,is_chl:1};Object(i.c)(e).then(function(e){0===e.error_code&&(t.loading=!1,t.currentTotal=e.data[0].total,t.tableData=e.data[0].data)})}catch(t){this.$message.error("获取数据失败")}},CurrentPage:function(t){this.currentPage=t,this.fetchData()},search:function(){var t=this;if(""!==this.searchVal.trim()){this.loading=!0,this.flag?this.lasrSearchVal!==this.searchVal&&(this.currentPage=1,this.$refs.pageN.init(),this.flag=!1):(this.lasrSearchVal=this.searchVal,this.flag=!0),this.isSearch||(this.currentPage=1,this.$refs.pageN.init()),this.isSearch=!0;var e="/Announcements/"+this.searchVal+"/"+this.currentPage+"/7/1";Object(i.d)(e).then(function(e){0===e.error_code?(t.loading=!1,t.currentTotal=e.data[0].total,t.tableData=e.data[0].data):t.loading=!1})}},handleSelectionChange:function(t){this.multipleSelection=t},handleCurrenttableChange:function(t){this.currentRow=t},tableRowClassName:function(t){var e=t.row;t.rowIndex;return console.log(e),0===e.status?"warning-row":""},edit:function(){var t=this;t.$refs.doDialog.open(this.currentRow),t.$refs.doDialog.onClosed=function(e){e.option===r.a.CONFIRM&&t.fetchData()}},addNew:function(){var t=this;t.$refs.doDialog.open(),t.$refs.doDialog.onClosed=function(e){e.option===r.a.CONFIRM&&t.fetchData()}},remove:function(){var t=this;this.$confirm("此操作将永久修改该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e=[];t.multipleSelection.length>0?e=t.multipleSelection:e.push(t.currentRow);var a=[],n=!0;if(e.map(function(t){0!==t.status?a.push(t.id):n=!1}),n){var r={deleted_id:a};Object(i.b)(r).then(function(e){1===e.error_code&&(t.fetchData(),t.$message({type:"success",message:"修改成功!"}))})}else t.$message.error("不可修改已失效公告"),a=[]}).catch(function(){t.$message({type:"info",message:"已取消修改"})})},openPdf:function(t){this.$refs.pdfViewer.open()}}},g=(a("3XZd"),Object(l.a)(f,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-card",{attrs:{shadow:"hover"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:9}},[a("titleLeft")],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("div",{staticClass:"prompt"},[t._v("\n          红色行表示该公告已失效\n        ")])]),t._v(" "),a("el-col",{attrs:{span:4}},[a("div",{staticStyle:{"text-align":"right"}},[a("el-input",{attrs:{placeholder:"请输入内容",clearable:""},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.search(e):null}},model:{value:t.searchVal,callback:function(e){t.searchVal=e},expression:"searchVal"}})],1)]),t._v(" "),a("el-col",{attrs:{span:1}},[a("el-button",{attrs:{disabled:!t.hasSearch,type:"primary",icon:"el-icon-search",circle:""},on:{click:function(e){t.search()}}})],1),t._v(" "),a("el-col",{attrs:{span:4}},[a("div",{staticStyle:{"text-align":"right"}},[this.$operationTrans[this.$store.state.routerAuth.canAdd]?a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline",circle:""},on:{click:function(e){t.addNew()}}}):t._e(),t._v(" "),this.$operationTrans[this.$store.state.routerAuth.canDelete]?a("el-button",{attrs:{disabled:!t.hasChecked,type:"warning",icon:"el-icon-refresh",circle:""},on:{click:function(e){t.remove()}}}):t._e()],1)])],1)],1),t._v(" "),a("el-card",{attrs:{shadow:"hover"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticClass:"floRight table",staticStyle:{width:"100%"},attrs:{data:t.tableData,"row-class-name":t.tableRowClassName,border:"","highlight-current-row":"","tooltip-effect":"dark"},on:{"current-change":t.handleCurrenttableChange,"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"35"}}),t._v(" "),a("el-table-column",{attrs:{prop:"title",label:"标题"}}),t._v(" "),a("el-table-column",{attrs:{prop:"content",label:"内容"}})],1)],1),t._v(" "),a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticClass:"block",staticStyle:{"text-align":"right"}},[a("pagination",{ref:"pageN",attrs:{"current-total":t.currentTotal,"current-page":t.currentPage},on:{CurrentPage:t.CurrentPage}})],1)]),t._v(" "),a("do-dialog",{ref:"doDialog"}),t._v(" "),a("pdf-viewer",{ref:"pdfViewer"})],1)},[],!1,null,"748cd013",null));g.options.__file="index.vue";e.default=g.exports}}]);